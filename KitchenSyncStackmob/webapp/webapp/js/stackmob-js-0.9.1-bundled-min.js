/*
 StackMob JS SDK Version 0.9.1 
 Copyright 2012-2013 StackMob Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 */

// JSON
// 2011-02-23
// Public Domain.
// http://www.JSON.org/json2.js

// Underscore.js 1.4.4
// http://underscorejs.org
// (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
// Underscore may be freely distributed under the MIT license.

// Backbone.js 1.0.0
// (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
// Backbone may be freely distributed under the MIT license.
// For all details and documentation:
// http://backbonejs.org
var JSON;JSON||(JSON={});
(function(){function e(a){return 10>a?"0"+a:a}function j(b){a.lastIndex=0;return a.test(b)?'"'+b.replace(a,function(a){var b=f[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function i(a,f){var e,l,k,s,y=d,x,r=f[a];r&&("object"===typeof r&&"function"===typeof r.toJSON)&&(r=r.toJSON(a));"function"===typeof n&&(r=n.call(f,a,r));switch(typeof r){case "string":return j(r);case "number":return isFinite(r)?String(r):"null";case "boolean":case "null":return String(r);case "object":if(!r)return"null";
d+=b;x=[];if("[object Array]"===Object.prototype.toString.apply(r)){s=r.length;for(e=0;e<s;e+=1)x[e]=i(e,r)||"null";k=0===x.length?"[]":d?"[\n"+d+x.join(",\n"+d)+"\n"+y+"]":"["+x.join(",")+"]";d=y;return k}if(n&&"object"===typeof n){s=n.length;for(e=0;e<s;e+=1)"string"===typeof n[e]&&(l=n[e],(k=i(l,r))&&x.push(j(l)+(d?": ":":")+k))}else for(l in r)Object.prototype.hasOwnProperty.call(r,l)&&(k=i(l,r))&&x.push(j(l)+(d?": ":":")+k);k=0===x.length?"{}":d?"{\n"+d+x.join(",\n"+d)+"\n"+y+"}":"{"+x.join(",")+
"}";d=y;return k}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var l=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d,b,f={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},n;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,f,e){var j;b=d="";if("number"===typeof e)for(j=0;j<e;j+=1)b+=" ";else"string"===typeof e&&(b=e);if((n=f)&&"function"!==typeof f&&("object"!==typeof f||"number"!==typeof f.length))throw Error("JSON.stringify");return i("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function d(a,f){var e,n,i=a[f];if(i&&"object"===typeof i)for(e in i)Object.prototype.hasOwnProperty.call(i,e)&&(n=d(i,e),void 0!==n?i[e]=n:delete i[e]);return b.call(a,f,i)}var f,a=String(a);l.lastIndex=0;l.test(a)&&(a=a.replace(l,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+a+")"),"function"===typeof b?d({"":f},""):f;throw new SyntaxError("JSON.parse");})})();(function(){var e=this,j=e._,i={},l=Array.prototype,a=Object.prototype,d=l.push,b=l.slice,f=l.concat,n=a.toString,u=a.hasOwnProperty,t=l.forEach,m=l.map,p=l.reduce,k=l.reduceRight,s=l.filter,y=l.every,x=l.some,r=l.indexOf,G=l.lastIndexOf,a=Array.isArray,J=Object.keys,C=Function.prototype.bind,h=function(c){return c instanceof h?c:this instanceof h?(this._wrapped=c,void 0):new h(c)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports._=h):e._=
h;h.VERSION="1.4.4";var w=h.each=h.forEach=function(c,q,a){if(null!=c)if(t&&c.forEach===t)c.forEach(q,a);else if(c.length===+c.length)for(var g=0,b=c.length;b>g&&q.call(a,c[g],g,c)!==i;g++);else for(g in c)if(h.has(c,g)&&q.call(a,c[g],g,c)===i)break};h.map=h.collect=function(c,q,g){var a=[];return null==c?a:m&&c.map===m?c.map(q,g):(w(c,function(c,b,d){a[a.length]=q.call(g,c,b,d)}),a)};h.reduce=h.foldl=h.inject=function(c,q,g,a){var b=2<arguments.length;if(null==c&&(c=[]),p&&c.reduce===p)return a&&
(q=h.bind(q,a)),b?c.reduce(q,g):c.reduce(q);if(w(c,function(c,d,f){b?g=q.call(a,g,c,d,f):(g=c,b=!0)}),!b)throw new TypeError("Reduce of empty array with no initial value");return g};h.reduceRight=h.foldr=function(c,q,g,a){var b=2<arguments.length;if(null==c&&(c=[]),k&&c.reduceRight===k)return a&&(q=h.bind(q,a)),b?c.reduceRight(q,g):c.reduceRight(q);var d=c.length;if(d!==+d)var f=h.keys(c),d=f.length;if(w(c,function(v,h,e){h=f?f[--d]:--d;b?g=q.call(a,g,c[h],h,e):(g=c[h],b=!0)}),!b)throw new TypeError("Reduce of empty array with no initial value");
return g};h.find=h.detect=function(c,q,g){var a;return H(c,function(c,b,d){return q.call(g,c,b,d)?(a=c,!0):void 0}),a};h.filter=h.select=function(c,q,g){var a=[];return null==c?a:s&&c.filter===s?c.filter(q,g):(w(c,function(c,b,d){q.call(g,c,b,d)&&(a[a.length]=c)}),a)};h.reject=function(c,q,g){return h.filter(c,function(c,a,b){return!q.call(g,c,a,b)},g)};h.every=h.all=function(c,q,g){q||(q=h.identity);var a=!0;return null==c?a:y&&c.every===y?c.every(q,g):(w(c,function(c,b,d){return(a=a&&q.call(g,c,
b,d))?void 0:i}),!!a)};var H=h.some=h.any=function(c,g,a){g||(g=h.identity);var b=!1;return null==c?b:x&&c.some===x?c.some(g,a):(w(c,function(c,d,f){return b||(b=g.call(a,c,d,f))?i:void 0}),!!b)};h.contains=h.include=function(c,g){return null==c?!1:r&&c.indexOf===r?-1!=c.indexOf(g):H(c,function(c){return c===g})};h.invoke=function(c,g){var a=b.call(arguments,2),d=h.isFunction(g);return h.map(c,function(c){return(d?g:c[g]).apply(c,a)})};h.pluck=function(c,g){return h.map(c,function(c){return c[g]})};
h.where=function(c,g,a){return h.isEmpty(g)?a?null:[]:h[a?"find":"filter"](c,function(c){for(var a in g)if(g[a]!==c[a])return!1;return!0})};h.findWhere=function(c,g){return h.where(c,g,!0)};h.max=function(c,g,a){if(!g&&h.isArray(c)&&c[0]===+c[0]&&65535>c.length)return Math.max.apply(Math,c);if(!g&&h.isEmpty(c))return-1/0;var b={computed:-1/0,value:-1/0};return w(c,function(c,d,f){d=g?g.call(a,c,d,f):c;d>=b.computed&&(b={value:c,computed:d})}),b.value};h.min=function(c,g,a){if(!g&&h.isArray(c)&&c[0]===
+c[0]&&65535>c.length)return Math.min.apply(Math,c);if(!g&&h.isEmpty(c))return 1/0;var b={computed:1/0,value:1/0};return w(c,function(c,d,f){d=g?g.call(a,c,d,f):c;b.computed>d&&(b={value:c,computed:d})}),b.value};h.shuffle=function(c){var g,a=0,b=[];return w(c,function(c){g=h.random(a++);b[a-1]=b[g];b[g]=c}),b};var D=function(c){return h.isFunction(c)?c:function(g){return g[c]}};h.sortBy=function(c,g,a){var b=D(g);return h.pluck(h.map(c,function(c,g,q){return{value:c,index:g,criteria:b.call(a,c,g,
q)}}).sort(function(c,g){var a=c.criteria,q=g.criteria;if(a!==q){if(a>q||void 0===a)return 1;if(q>a||void 0===q)return-1}return c.index<g.index?-1:1}),"value")};var z=function(c,g,a,b){var d={},f=D(g||h.identity);return w(c,function(g,q){var v=f.call(a,g,q,c);b(d,v,g)}),d};h.groupBy=function(c,g,a){return z(c,g,a,function(c,g,a){(h.has(c,g)?c[g]:c[g]=[]).push(a)})};h.countBy=function(c,g,a){return z(c,g,a,function(c,g){h.has(c,g)||(c[g]=0);c[g]++})};h.sortedIndex=function(c,g,a,b){for(var a=null==
a?h.identity:D(a),g=a.call(b,g),d=0,f=c.length;f>d;){var v=d+f>>>1;g>a.call(b,c[v])?d=v+1:f=v}return d};h.toArray=function(c){return c?h.isArray(c)?b.call(c):c.length===+c.length?h.map(c,h.identity):h.values(c):[]};h.size=function(c){return null==c?0:c.length===+c.length?c.length:h.keys(c).length};h.first=h.head=h.take=function(c,g,a){return null==c?void 0:null==g||a?c[0]:b.call(c,0,g)};h.initial=function(c,g,a){return b.call(c,0,c.length-(null==g||a?1:g))};h.last=function(c,g,a){return null==c?void 0:
null==g||a?c[c.length-1]:b.call(c,Math.max(c.length-g,0))};h.rest=h.tail=h.drop=function(c,g,a){return b.call(c,null==g||a?1:g)};h.compact=function(c){return h.filter(c,h.identity)};var E=function(c,g,a){return w(c,function(c){h.isArray(c)?g?d.apply(a,c):E(c,g,a):a.push(c)}),a};h.flatten=function(c,g){return E(c,g,[])};h.without=function(c){return h.difference(c,b.call(arguments,1))};h.uniq=h.unique=function(c,g,a,b){h.isFunction(g)&&(b=a,a=g,g=!1);var a=a?h.map(c,a,b):c,d=[],f=[];return w(a,function(a,
b){(g?b&&f[f.length-1]===a:h.contains(f,a))||(f.push(a),d.push(c[b]))}),d};h.union=function(){return h.uniq(f.apply(l,arguments))};h.intersection=function(c){var g=b.call(arguments,1);return h.filter(h.uniq(c),function(c){return h.every(g,function(g){return 0<=h.indexOf(g,c)})})};h.difference=function(c){var g=f.apply(l,b.call(arguments,1));return h.filter(c,function(c){return!h.contains(g,c)})};h.zip=function(){for(var c=b.call(arguments),g=h.max(h.pluck(c,"length")),a=Array(g),d=0;g>d;d++)a[d]=
h.pluck(c,""+d);return a};h.object=function(c,g){if(null==c)return{};for(var a={},b=0,d=c.length;d>b;b++)g?a[c[b]]=g[b]:a[c[b][0]]=c[b][1];return a};h.indexOf=function(c,g,a){if(null==c)return-1;var b=0,d=c.length;if(a){if("number"!=typeof a)return b=h.sortedIndex(c,g),c[b]===g?b:-1;b=0>a?Math.max(0,d+a):a}if(r&&c.indexOf===r)return c.indexOf(g,a);for(;d>b;b++)if(c[b]===g)return b;return-1};h.lastIndexOf=function(c,g,a){if(null==c)return-1;var b=null!=a;if(G&&c.lastIndexOf===G)return b?c.lastIndexOf(g,
a):c.lastIndexOf(g);for(a=b?a:c.length;a--;)if(c[a]===g)return a;return-1};h.range=function(c,g,a){1>=arguments.length&&(g=c||0,c=0);for(var a=arguments[2]||1,b=Math.max(Math.ceil((g-c)/a),0),d=0,f=Array(b);b>d;)f[d++]=c,c+=a;return f};h.bind=function(c,g){if(c.bind===C&&C)return C.apply(c,b.call(arguments,1));var a=b.call(arguments,2);return function(){return c.apply(g,a.concat(b.call(arguments)))}};h.partial=function(c){var g=b.call(arguments,1);return function(){return c.apply(this,g.concat(b.call(arguments)))}};
h.bindAll=function(c){var g=b.call(arguments,1);return 0===g.length&&(g=h.functions(c)),w(g,function(g){c[g]=h.bind(c[g],c)}),c};h.memoize=function(c,g){var a={};return g||(g=h.identity),function(){var b=g.apply(this,arguments);return h.has(a,b)?a[b]:a[b]=c.apply(this,arguments)}};h.delay=function(c,g){var a=b.call(arguments,2);return setTimeout(function(){return c.apply(null,a)},g)};h.defer=function(c){return h.delay.apply(h,[c,1].concat(b.call(arguments,1)))};h.throttle=function(c,g){var a,b,d,
f,v=0,h=function(){v=new Date;d=null;f=c.apply(a,b)};return function(){var e=new Date,k=g-(e-v);return a=this,b=arguments,0>=k?(clearTimeout(d),d=null,v=e,f=c.apply(a,b)):d||(d=setTimeout(h,k)),f}};h.debounce=function(c,g,a){var b,d;return function(){var f=this,v=arguments,h=a&&!b;return clearTimeout(b),b=setTimeout(function(){b=null;a||(d=c.apply(f,v))},g),h&&(d=c.apply(f,v)),d}};h.once=function(c){var g,a=!1;return function(){return a?g:(a=!0,g=c.apply(this,arguments),c=null,g)}};h.wrap=function(c,
g){return function(){var a=[c];return d.apply(a,arguments),g.apply(this,a)}};h.compose=function(){var c=arguments;return function(){for(var g=arguments,a=c.length-1;0<=a;a--)g=[c[a].apply(this,g)];return g[0]}};h.after=function(c,g){return 0>=c?g():function(){return 1>--c?g.apply(this,arguments):void 0}};h.keys=J||function(c){if(c!==Object(c))throw new TypeError("Invalid object");var g=[],a;for(a in c)h.has(c,a)&&(g[g.length]=a);return g};h.values=function(c){var g=[],a;for(a in c)h.has(c,a)&&g.push(c[a]);
return g};h.pairs=function(c){var g=[],a;for(a in c)h.has(c,a)&&g.push([a,c[a]]);return g};h.invert=function(c){var g={},a;for(a in c)h.has(c,a)&&(g[c[a]]=a);return g};h.functions=h.methods=function(c){var g=[],a;for(a in c)h.isFunction(c[a])&&g.push(a);return g.sort()};h.extend=function(c){return w(b.call(arguments,1),function(g){if(g)for(var a in g)c[a]=g[a]}),c};h.pick=function(c){var g={},a=f.apply(l,b.call(arguments,1));return w(a,function(a){a in c&&(g[a]=c[a])}),g};h.omit=function(c){var g=
{},a=f.apply(l,b.call(arguments,1)),d;for(d in c)h.contains(a,d)||(g[d]=c[d]);return g};h.defaults=function(c){return w(b.call(arguments,1),function(g){if(g)for(var a in g)null==c[a]&&(c[a]=g[a])}),c};h.clone=function(c){return h.isObject(c)?h.isArray(c)?c.slice():h.extend({},c):c};h.tap=function(c,g){return g(c),c};var F=function(c,g,a,b){if(c===g)return 0!==c||1/c==1/g;if(null==c||null==g)return c===g;c instanceof h&&(c=c._wrapped);g instanceof h&&(g=g._wrapped);var d=n.call(c);if(d!=n.call(g))return!1;
switch(d){case "[object String]":return c==g+"";case "[object Number]":return c!=+c?g!=+g:0==c?1/c==1/g:c==+g;case "[object Date]":case "[object Boolean]":return+c==+g;case "[object RegExp]":return c.source==g.source&&c.global==g.global&&c.multiline==g.multiline&&c.ignoreCase==g.ignoreCase}if("object"!=typeof c||"object"!=typeof g)return!1;for(var f=a.length;f--;)if(a[f]==c)return b[f]==g;a.push(c);b.push(g);var f=0,v=!0;if("[object Array]"==d){if(f=c.length,v=f==g.length)for(;f--&&(v=F(c[f],g[f],
a,b)););}else{var d=c.constructor,e=g.constructor;if(d!==e&&(!h.isFunction(d)||!(d instanceof d&&h.isFunction(e)&&e instanceof e)))return!1;for(var k in c)if(h.has(c,k)&&(f++,!(v=h.has(g,k)&&F(c[k],g[k],a,b))))break;if(v){for(k in g)if(h.has(g,k)&&!f--)break;v=!f}}return a.pop(),b.pop(),v};h.isEqual=function(c,g){return F(c,g,[],[])};h.isEmpty=function(c){if(null==c)return!0;if(h.isArray(c)||h.isString(c))return 0===c.length;for(var g in c)if(h.has(c,g))return!1;return!0};h.isElement=function(c){return!(!c||
1!==c.nodeType)};h.isArray=a||function(c){return"[object Array]"==n.call(c)};h.isObject=function(c){return c===Object(c)};w("Arguments Function String Number Date RegExp".split(" "),function(c){h["is"+c]=function(g){return n.call(g)=="[object "+c+"]"}});h.isArguments(arguments)||(h.isArguments=function(c){return!(!c||!h.has(c,"callee"))});"function"!=typeof/./&&(h.isFunction=function(c){return"function"==typeof c});h.isFinite=function(c){return isFinite(c)&&!isNaN(parseFloat(c))};h.isNaN=function(c){return h.isNumber(c)&&
c!=+c};h.isBoolean=function(c){return!0===c||!1===c||"[object Boolean]"==n.call(c)};h.isNull=function(c){return null===c};h.isUndefined=function(c){return void 0===c};h.has=function(c,g){return u.call(c,g)};h.noConflict=function(){return e._=j,this};h.identity=function(c){return c};h.times=function(c,g,a){for(var b=Array(c),d=0;c>d;d++)b[d]=g.call(a,d);return b};h.random=function(c,g){return null==g&&(g=c,c=0),c+Math.floor(Math.random()*(g-c+1))};var B={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;",
"'":"&#x27;","/":"&#x2F;"}};B.unescape=h.invert(B.escape);var K={escape:RegExp("["+h.keys(B.escape).join("")+"]","g"),unescape:RegExp("("+h.keys(B.unescape).join("|")+")","g")};h.each(["escape","unescape"],function(c){h[c]=function(g){return null==g?"":(""+g).replace(K[c],function(g){return B[c][g]})}});h.result=function(c,g){if(null==c)return null;var a=c[g];return h.isFunction(a)?a.call(c):a};h.mixin=function(c){w(h.functions(c),function(g){var a=h[g]=c[g];h.prototype[g]=function(){var c=[this._wrapped];
d.apply(c,arguments);c=a.apply(h,c);return this._chain?h(c).chain():c}})};var I=0;h.uniqueId=function(c){var g=++I+"";return c?c+g:g};h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,g={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},v=/\\|'|\r|\n|\t|\u2028|\u2029/g;h.template=function(c,a,b){var d,b=h.defaults({},b,h.templateSettings),f=RegExp([(b.escape||A).source,(b.interpolate||A).source,(b.evaluate||
A).source].join("|")+"|$","g"),e=0,k="__p+='";c.replace(f,function(a,b,d,f,h){return k+=c.slice(e,h).replace(v,function(c){return"\\"+g[c]}),b&&(k+="'+\n((__t=("+b+"))==null?'':_.escape(__t))+\n'"),d&&(k+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),f&&(k+="';\n"+f+"\n__p+='"),e=h+a.length,a});k+="';\n";b.variable||(k="with(obj||{}){\n"+k+"}\n");k="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+k+"return __p;\n";try{d=Function(b.variable||"obj","_",k)}catch(n){throw n.source=
k,n;}if(a)return d(a,h);a=function(c){return d.call(this,c,h)};return a.source="function("+(b.variable||"obj")+"){\n"+k+"}",a};h.chain=function(c){return h(c).chain()};h.mixin(h);w("pop push reverse shift sort splice unshift".split(" "),function(c){var g=l[c];h.prototype[c]=function(){var a=this._wrapped;return g.apply(a,arguments),"shift"!=c&&"splice"!=c||0!==a.length||delete a[0],this._chain?h(a).chain():a}});w(["concat","join","slice"],function(c){var g=l[c];h.prototype[c]=function(){var c=g.apply(this._wrapped,
arguments);return this._chain?h(c).chain():c}});h.extend(h.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);(function(){var e=this,j=e.Backbone,i=[],l=i.push,a=i.slice,d=i.splice,b;b="undefined"!==typeof exports?exports:e.Backbone={};b.VERSION="1.0.0";var f=e._;!f&&"undefined"!==typeof require&&(f=require("underscore"));b.$=e.jQuery||e.Zepto||e.ender||e.$;b.noConflict=function(){e.Backbone=j;return this};b.emulateHTTP=!1;b.emulateJSON=!1;var n=b.Events={on:function(g,a,c){if(!t(this,"on",g,[a,c])||!a)return this;this._events||(this._events={});(this._events[g]||(this._events[g]=[])).push({callback:a,context:c,
ctx:c||this});return this},once:function(g,a,c){if(!t(this,"once",g,[a,c])||!a)return this;var b=this,d=f.once(function(){b.off(g,d);a.apply(this,arguments)});d._callback=a;return this.on(g,d,c)},off:function(g,a,c){var b,d,h,e,k,n,i,j;if(!this._events||!t(this,"off",g,[a,c]))return this;if(!g&&!a&&!c)return this._events={},this;e=g?[g]:f.keys(this._events);k=0;for(n=e.length;k<n;k++)if(g=e[k],h=this._events[g]){this._events[g]=b=[];if(a||c){i=0;for(j=h.length;i<j;i++)d=h[i],(a&&a!==d.callback&&a!==
d.callback._callback||c&&c!==d.context)&&b.push(d)}b.length||delete this._events[g]}return this},trigger:function(g){if(!this._events)return this;var b=a.call(arguments,1);if(!t(this,"trigger",g,b))return this;var c=this._events[g],d=this._events.all;c&&m(c,b);d&&m(d,arguments);return this},stopListening:function(g,a,c){var b=this._listeners;if(!b)return this;var d=!a&&!c;"object"===typeof a&&(c=this);g&&((b={})[g._listenerId]=g);for(var f in b)b[f].off(a,c,this),d&&delete this._listeners[f];return this}},
u=/\s+/,t=function(g,a,c,b){if(!c)return!0;if("object"===typeof c){for(var d in c)g[a].apply(g,[d,c[d]].concat(b));return!1}if(u.test(c)){c=c.split(u);d=0;for(var f=c.length;d<f;d++)g[a].apply(g,[c[d]].concat(b));return!1}return!0},m=function(g,a){var c,b=-1,d=g.length,f=a[0],h=a[1],e=a[2];switch(a.length){case 0:for(;++b<d;)(c=g[b]).callback.call(c.ctx);break;case 1:for(;++b<d;)(c=g[b]).callback.call(c.ctx,f);break;case 2:for(;++b<d;)(c=g[b]).callback.call(c.ctx,f,h);break;case 3:for(;++b<d;)(c=
g[b]).callback.call(c.ctx,f,h,e);break;default:for(;++b<d;)(c=g[b]).callback.apply(c.ctx,a)}};f.each({listenTo:"on",listenToOnce:"once"},function(g,a){n[a]=function(c,a,b){var d=this._listeners||(this._listeners={}),v=c._listenerId||(c._listenerId=f.uniqueId("l"));d[v]=c;"object"===typeof a&&(b=this);c[g](a,b,this);return this}});n.bind=n.on;n.unbind=n.off;f.extend(b,n);var p=b.Model=function(g,a){var c,b=g||{};a||(a={});this.cid=f.uniqueId("c");this.attributes={};f.extend(this,f.pick(a,k));a.parse&&
(b=this.parse(b,a)||{});if(c=f.result(this,"defaults"))b=f.defaults({},b,c);this.set(b,a);this.changed={};this.initialize.apply(this,arguments)},k=["url","urlRoot","collection"];f.extend(p.prototype,n,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},sync:function(){return b.sync.apply(this,arguments)},get:function(g){return this.attributes[g]},escape:function(g){return f.escape(this.get(g))},has:function(g){return null!=
this.get(g)},set:function(g,a,c){var b,d,h,e,k,n,i;if(null==g)return this;"object"===typeof g?(d=g,c=a):(d={})[g]=a;c||(c={});if(!this._validate(d,c))return!1;h=c.unset;e=c.silent;g=[];k=this._changing;this._changing=!0;k||(this._previousAttributes=f.clone(this.attributes),this.changed={});i=this.attributes;n=this._previousAttributes;this.idAttribute in d&&(this.id=d[this.idAttribute]);for(b in d)a=d[b],f.isEqual(i[b],a)||g.push(b),f.isEqual(n[b],a)?delete this.changed[b]:this.changed[b]=a,h?delete i[b]:
i[b]=a;if(!e){g.length&&(this._pending=!0);a=0;for(b=g.length;a<b;a++)this.trigger("change:"+g[a],this,i[g[a]],c)}if(k)return this;if(!e)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);this._changing=this._pending=!1;return this},unset:function(g,a){return this.set(g,void 0,f.extend({},a,{unset:!0}))},clear:function(g){var a={},c;for(c in this.attributes)a[c]=void 0;return this.set(a,f.extend({},g,{unset:!0}))},hasChanged:function(g){return null==g?!f.isEmpty(this.changed):f.has(this.changed,
g)},changedAttributes:function(g){if(!g)return this.hasChanged()?f.clone(this.changed):!1;var a,c=!1,b=this._changing?this._previousAttributes:this.attributes,d;for(d in g)if(!f.isEqual(b[d],a=g[d]))(c||(c={}))[d]=a;return c},previous:function(a){return null==a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d){if(!b.set(b.parse(d,
a),a))return!1;c&&c(b,d,a);b.trigger("sync",b,d,a)};A(this,a);return this.sync("read",this,a)},save:function(a,b,c){var d,h=this.attributes;null==a||"object"===typeof a?(d=a,c=b):(d={})[a]=b;if(d&&(!c||!c.wait)&&!this.set(d,c))return!1;c=f.extend({validate:!0},c);if(!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=f.extend({},h,d));void 0===c.parse&&(c.parse=!0);var e=this,k=c.success;c.success=function(a){e.attributes=h;var g=e.parse(a,c);c.wait&&(g=f.extend(d||{},g));if(f.isObject(g)&&
!e.set(g,c))return!1;k&&k(e,a,c);e.trigger("sync",e,a,c)};A(this,c);a=this.isNew()?"create":c.patch?"patch":"update";"patch"===a&&(c.attrs=d);a=this.sync(a,this,c);d&&c.wait&&(this.attributes=h);return a},destroy:function(a){var a=a?f.clone(a):{},b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};a.success=function(f){(a.wait||b.isNew())&&d();c&&c(b,f,a);b.isNew()||b.trigger("sync",b,f,a)};if(this.isNew())return a.success(),!1;A(this,a);var h=this.sync("delete",this,a);a.wait||
d();return h},url:function(){var a=f.result(this,"urlRoot")||f.result(this.collection,"url")||I();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},f.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;var a=f.extend({},this.attributes,a),c=this.validationError=
this.validate(a,b)||null;if(!c)return!0;this.trigger("invalid",this,c,f.extend(b||{},{validationError:c}));return!1}});f.each("keys values pairs invert pick omit".split(" "),function(g){p.prototype[g]=function(){var b=a.call(arguments);b.unshift(this.attributes);return f[g].apply(f,b)}});var s=b.Collection=function(a,b){b||(b={});b.url&&(this.url=b.url);b.model&&(this.model=b.model);void 0!==b.comparator&&(this.comparator=b.comparator);this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,
f.extend({silent:!0},b))},y={add:!0,remove:!0,merge:!0},x={add:!0,merge:!1,remove:!1};f.extend(s.prototype,n,{model:p,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return b.sync.apply(this,arguments)},add:function(a,b){return this.set(a,f.defaults(b||{},x))},remove:function(a,b){a=f.isArray(a)?a.slice():[a];b||(b={});var c,d,h,e;c=0;for(d=a.length;c<d;c++)if(e=this.get(a[c]))delete this._byId[e.id],delete this._byId[e.cid],h=this.indexOf(e),
this.models.splice(h,1),this.length--,b.silent||(b.index=h,e.trigger("remove",e,this,b)),this._removeReference(e);return this},set:function(a,b){b=f.defaults(b||{},y);b.parse&&(a=this.parse(a,b));f.isArray(a)||(a=a?[a]:[]);var c,h,e,k,i,n=b.at,j=this.comparator&&null==n&&!1!==b.sort,s=f.isString(this.comparator)?this.comparator:null,m=[],u=[],t={};c=0;for(h=a.length;c<h;c++)if(e=this._prepareModel(a[c],b))(k=this.get(e))?(b.remove&&(t[k.cid]=!0),b.merge&&(k.set(e.attributes,b),j&&(!i&&k.hasChanged(s))&&
(i=!0))):b.add&&(m.push(e),e.on("all",this._onModelEvent,this),this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e));if(b.remove){c=0;for(h=this.length;c<h;++c)t[(e=this.models[c]).cid]||u.push(e);u.length&&this.remove(u,b)}m.length&&(j&&(i=!0),this.length+=m.length,null!=n?d.apply(this.models,[n,0].concat(m)):l.apply(this.models,m));i&&this.sort({silent:!0});if(b.silent)return this;c=0;for(h=m.length;c<h;c++)(e=m[c]).trigger("add",e,this,b);i&&this.trigger("sort",this,b);return this},reset:function(a,
b){b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);b.previousModels=this.models;this._reset();this.add(a,f.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,f.extend({at:this.length},b));return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,f.extend({at:0},b));return a},shift:function(a){var b=
this.at(0);this.remove(b,a);return b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a.cid||a]},at:function(a){return this.models[a]},where:function(a,b){return f.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(c){for(var b in a)if(a[b]!==c.get(b))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");a||(a={});f.isString(this.comparator)||
1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(f.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},sortedIndex:function(a,b,c){b||(b=this.comparator);var d=f.isFunction(b)?b:function(a){return a.get(b)};return f.sortedIndex(this.models,a,d,c)},pluck:function(a){return f.invoke(this.models,"get",a)},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;a.success=function(d){c[a.reset?"reset":
"set"](d,a);b&&b(c,d,a);c.trigger("sync",c,d,a)};A(this,a);return this.sync("read",this,a)},create:function(a,b){b=b?f.clone(b):{};if(!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;b.success=function(f){b.wait&&c.add(a,b);d&&d(a,f,b)};a.save(null,b);return a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,b){if(a instanceof p)return a.collection||
(a.collection=this),a;b||(b={});b.collection=this;var c=new this.model(a,b);return!c._validate(a,b)?(this.trigger("invalid",this,a,b),!1):c},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});
f.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(b){s.prototype[b]=function(){var d=a.call(arguments);d.unshift(this.models);return f[b].apply(f,d)}});f.each(["groupBy","countBy","sortBy"],function(a){s.prototype[a]=function(b,c){var d=f.isFunction(b)?b:function(a){return a.get(b)};
return f[a](this.models,d,c)}});var i=b.View=function(a){this.cid=f.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},r=/^(\S+)\s*(.*)$/,G="model collection el id attributes className tagName events".split(" ");f.extend(i.prototype,n,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(a,
d){this.$el&&this.undelegateEvents();this.$el=a instanceof b.$?a:b.$(a);this.el=this.$el[0];!1!==d&&this.delegateEvents();return this},delegateEvents:function(a){if(!a&&!(a=f.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(c){var d=b.match(r),h=d[1],d=d[2],c=f.bind(c,this),h=h+(".delegateEvents"+this.cid);if(""===d)this.$el.on(h,c);else this.$el.on(h,d,c)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+
this.cid);return this},_configure:function(a){this.options&&(a=f.extend({},f.result(this,"options"),a));f.extend(this,f.pick(a,G));this.options=a},_ensureElement:function(){if(this.el)this.setElement(f.result(this,"el"),!1);else{var a=f.extend({},f.result(this,"attributes"));this.id&&(a.id=f.result(this,"id"));this.className&&(a["class"]=f.result(this,"className"));a=b.$("<"+f.result(this,"tagName")+">").attr(a);this.setElement(a,!1)}}});b.sync=function(a,d,c){var h=J[a];f.defaults(c||(c={}),{emulateHTTP:b.emulateHTTP,
emulateJSON:b.emulateJSON});var e={type:h,dataType:"json"};c.url||(e.url=f.result(d,"url")||I());if(null==c.data&&d&&("create"===a||"update"===a||"patch"===a))e.contentType="application/json",e.data=JSON.stringify(c.attrs||d.toJSON(c));c.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(c.emulateHTTP&&("PUT"===h||"DELETE"===h||"PATCH"===h)){e.type="POST";c.emulateJSON&&(e.data._method=h);var k=c.beforeSend;c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",
h);if(k)return k.apply(this,arguments)}}"GET"!==e.type&&!c.emulateJSON&&(e.processData=!1);if("PATCH"===e.type&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled))e.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")};a=c.xhr=b.ajax(f.extend(e,c));d.trigger("request",d,a,c);return a};var J={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};b.ajax=function(){return b.$.ajax.apply(b.$,arguments)};var C=b.Router=function(a){a||(a={});a.routes&&
(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},h=/\((.*?)\)/g,w=/(\(\?)?:\w+/g,H=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;f.extend(C.prototype,n,{initialize:function(){},route:function(a,d,c){f.isRegExp(a)||(a=this._routeToRegExp(a));f.isFunction(d)&&(c=d,d="");c||(c=this[d]);var h=this;b.history.route(a,function(f){f=h._extractParameters(a,f);c&&c.apply(h,f);h.trigger.apply(h,["route:"+d].concat(f));h.trigger("route",d,f);b.history.trigger("route",h,d,f)});return this},
navigate:function(a,d){b.history.navigate(a,d);return this},_bindRoutes:function(){if(this.routes){this.routes=f.result(this,"routes");for(var a,b=f.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){a=a.replace(D,"\\$&").replace(h,"(?:$1)?").replace(w,function(a,c){return c?a:"([^/]+)"}).replace(H,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return f.map(c,function(a){return a?decodeURIComponent(a):null})}});
var z=b.History=function(){this.handlers=[];f.bindAll(this,"checkUrl");"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,F=/^\/+|\/+$/g,B=/msie [\w.]+/,K=/\/$/;z.started=!1;f.extend(z.prototype,n,{interval:50,getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){var a=this.location.pathname,c=this.root.replace(K,"");a.indexOf(c)||
(a=a.substr(c.length))}else a=this.getHash();return a.replace(E,"")},start:function(a){if(z.started)throw Error("Backbone.history has already been started");z.started=!0;this.options=f.extend({},{root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState);var a=this.getFragment(),d=document.documentMode,d=B.exec(navigator.userAgent.toLowerCase())&&
(!d||7>=d);this.root=("/"+this.root+"/").replace(F,"/");d&&this._wantsHashChange&&(this.iframe=b.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a));if(this._hasPushState)b.$(window).on("popstate",this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in window&&!d)b.$(window).on("hashchange",this.checkUrl);else this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=a;a=this.location;d=a.pathname.replace(/[^\/]$/,
"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!d)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&(this._hasPushState&&d&&a.hash)&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search));if(!this.options.silent)return this.loadUrl()},stop:function(){b.$(window).off("popstate",this.checkUrl).off("hashchange",
this.checkUrl);clearInterval(this._checkUrlInterval);z.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),
!0})},navigate:function(a,b){if(!z.started)return!1;if(!b||!0===b)b={trigger:b};a=this.getFragment(a||"");if(this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else if(this._wantsHashChange)this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace));else return this.location.assign(c);
b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b}});b.history=new z;p.extend=s.extend=C.extend=i.extend=z.extend=function(a,b){var c=this,d;d=a&&f.has(a,"constructor")?a.constructor:function(){return c.apply(this,arguments)};f.extend(d,c,b);var h=function(){this.constructor=d};h.prototype=c.prototype;d.prototype=new h;a&&f.extend(d.prototype,a);d.__super__=c.prototype;return d};var I=function(){throw Error('A "url" property or function must be specified');
},A=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b);a.trigger("error",a,d,b)}}}).call(this);(function(){window.StackMob=this.StackMob={DEFAULT_API_VERSION:0,DEFAULT_LOGIN_SCHEMA:"user",DEFAULT_LOGIN_FIELD:"username",DEFAULT_PASSWORD_FIELD:"password",EARTH_RADIANS_MI:3956.6,EARTH_RADIANS_KM:6367.5,FORCE_CREATE_REQUEST:"stackmob_force_create_request",ARRAY_FIELDNAME:"stackmob_array_fieldname",ARRAY_VALUES:"stackmob_array_values",CASCADE_DELETE:"stackmob_cascade_delete",HARD_DELETE:!0,SOFT_DELETE:!1,API_SERVER:"api.stackmob.com",RETRY_WAIT:1E4,RETRY_ATTEMPTS:3,REFRESH_TOKEN_KEY:"oauth2.refreshToken",
POST:"POST",PUT:"PUT",DELETE:"DELETE",CONTENT_TYPE_JSON:"application/json",SECURE_ALWAYS:"ALWAYS",SECURE_MIXED:"MIXED",SECURE_NEVER:"NEVER",apiVersion:0,sdkVersion:"0.9.1",publicKey:null,Storage:{STORAGE_PREFIX:"stackmob.",persist:function(e,j){localStorage&&localStorage.setItem(this.STORAGE_PREFIX+e,j)},retrieve:function(e){return localStorage?localStorage.getItem(this.STORAGE_PREFIX+e):null},remove:function(e){localStorage&&localStorage.removeItem(this.STORAGE_PREFIX+e)}},_generateCallbacks:function(e,
j){e=e||{};e.success=function(e){j.isValidResult(e)?"function"===typeof j.yes&&j.yes(e):"function"===typeof j.no&&j.no(e)};!e.error&&"function"===typeof j.error&&(e.error=j.error);return e},_containsCallbacks:function(e,j){return"object"===typeof e&&_.some(j,function(i){return"function"===typeof e[i]})},getLoggedInUser:function(e){var j=!this.isOAuth2Mode()&&this.Storage.retrieve(this.loggedInUserKey)||this.Storage.retrieve("oauth2.user");if(e&&e.success)this.hasValidOAuth(e);else return this.isLoggedIn(e)&&
j?j:null},isLoggedIn:function(e){if(this._containsCallbacks(e,["yes","no"]))e=this._generateCallbacks(e,{isValidResult:function(e){return"undefined"!==typeof e},yes:e.yes,no:e.no,error:e.no}),this.hasValidOAuth(e);else return!this.isLoggedOut()||this.hasValidOAuth(e)},isUserLoggedIn:function(e,j){if(this._containsCallbacks(j,["yes","no"]))j=this._generateCallbacks(j,{isValidResult:function(i){return i==e},yes:j.yes,no:j.no,error:j.no}),this.hasValidOAuth(j);else return e==this.getLoggedInUser(j)},
isLoggedOut:function(e){if(this._containsCallbacks(e,["yes","no"]))e=this._generateCallbacks(e,{isValidResult:function(e){return"undefined"==typeof e},yes:e.yes,no:e.no,error:e.yes}),this.hasValidOAuth(e);else return!this.hasValidOAuth(e)},getBaseURL:function(){return StackMob.useRelativePathForAjax?StackMob.apiDomain?StackMob.apiDomain:window.location.hostname+(window.location.port?":"+window.location.port:"")+"/":StackMob.apiDomain?StackMob.apiDomain:StackMob.API_SERVER+"/"},throwError:function(e){throw Error(e);
},urlError:function(){this.throwError('A "url" property or function must be specified')},requirePublicKey:function(){StackMob.publicKey||this.throwError("Error: This requires that you initialize StackMob with a public key.")},isOAuth2Mode:function(){return!isNaN(StackMob.publicKey&&!StackMob.privateKey)},prepareCredsForSaving:function(e,j,i,l,a,d){l=(new Date).getTime()+1E3*this._stubbedExpireTime(l);e={"oauth2.accessToken":e,"oauth2.macKey":i,"oauth2.expires":l,"oauth2.user":a,"oauth2.userSchemaInfo":d};
e[StackMob.REFRESH_TOKEN_KEY]=j;return e},_stubbedExpireTime:function(e){return e},saveOAuthCredentials:function(e){var j=e["oauth2.accessToken"],i=e[StackMob.REFRESH_TOKEN_KEY];this.Storage.retrieve("oauth2.accessToken")!=j&&this.Storage.persist("oauth2.expires",e["oauth2.expires"]);this.Storage.persist("oauth2.accessToken",j);this.Storage.persist(StackMob.REFRESH_TOKEN_KEY,i);this.Storage.persist("oauth2.macKey",e["oauth2.macKey"]);this.Storage.persist("oauth2.user",e["oauth2.user"]);this.Storage.persist("oauth2.userSchemaInfo",
JSON.stringify(e["oauth2.userSchemaInfo"]))},hasValidOAuth:function(e){e=e||{};if(!this.isOAuth2Mode())return e&&e.error&&e.error(),!1;var j=this.getOAuthCredentials();if(!_.all([j["oauth2.accessToken"],j["oauth2.macKey"],j&&j["oauth2.expires"]||0],_.identity))return e&&e.success&&e.success(void 0),!1;if(StackMob.hasExpiredOAuth())if(e&&e.success){var i=e.success;e.success=function(e){var a=StackMob.getOAuthCredentials();i(e[a["oauth2.userSchemaInfo"]&&a["oauth2.userSchemaInfo"].loginField?a["oauth2.userSchemaInfo"].loginField:
this.loginField])};this.initiateRefreshSessionCall(e)}else return!1;else return e&&e.success&&e.success(this.Storage.retrieve("oauth2.user")),this.Storage.retrieve("oauth2.user")},initiateRefreshSessionCall:function(e){StackMob.refreshSession.call(StackMob,e)},shouldSendRefreshToken:function(){return this.hasExpiredOAuth()&&this.hasRefreshToken()&&this.shouldKeepLoggedIn()},keepLoggedIn:function(e){StackMob.Storage.persist("oauth2.shouldKeepLoggedIn",!0===e)},shouldKeepLoggedIn:function(){return"true"===
StackMob.Storage.retrieve("oauth2.shouldKeepLoggedIn")},hasRefreshToken:function(){var e=this.getOAuthCredentials();return e&&"undefined"!==typeof e[StackMob.REFRESH_TOKEN_KEY]&&null!=e[StackMob.REFRESH_TOKEN_KEY]},getRefreshToken:function(){return this.getOAuthCredentials()[StackMob.REFRESH_TOKEN_KEY]},hasExpiredOAuth:function(){return this.isOAuth2Mode()&&null==this.getOAuthExpireTime()||this.getOAuthExpireTime()<=(new Date).getTime()},clearOAuthCredentials:function(){StackMob.Storage.remove(StackMob.loggedInUserKey);
StackMob.Storage.remove("oauth2.accessToken");StackMob.Storage.remove(StackMob.REFRESH_TOKEN_KEY);StackMob.Storage.remove("oauth2.macKey");StackMob.Storage.remove("oauth2.expires");StackMob.Storage.remove("oauth2.user");StackMob.Storage.remove("oauth2.userSchemaInfo")},getOAuthCredentials:function(){var e=StackMob.Storage.retrieve("oauth2.accessToken"),j=StackMob.Storage.retrieve("oauth2.macKey"),i=StackMob.Storage.retrieve("oauth2.expires"),l=StackMob.Storage.retrieve(StackMob.REFRESH_TOKEN_KEY),
a=StackMob.Storage.retrieve("oauth2.userSchemaInfo"),d=null;try{d=JSON.parse(a)}catch(b){}return _.every([e,j,i,l,d])?(e={"oauth2.accessToken":e,"oauth2.macKey":j,"oauth2.expires":i,"oauth2.userSchemaInfo":d},e[StackMob.REFRESH_TOKEN_KEY]=l,e):{}},getOAuthExpireTime:function(){var e=this.Storage.retrieve("oauth2.expires");return e?parseInt(e):null},METHOD_MAP:{create:"POST",read:"GET",update:"PUT","delete":"DELETE",post:"POST",get:"GET",put:"PUT",addRelationship:"POST",appendAndSave:"PUT",deleteAndSave:"DELETE",
login:"GET",accessToken:"POST",refreshToken:"POST",logout:"GET",forgotPassword:"POST",loginWithTempAndSetNewPassword:"GET",resetPassword:"POST",facebookAccessToken:"POST",facebookAccessTokenWithCreate:"POST",createUserWithFacebook:"POST",linkUserWithFacebook:"GET",unlinkUserFromFacebook:"DELETE",gigyaAccessToken:"POST",linkUserWithGigya:"POST",unlinkUserFromGigya:"DELETE"},getProperty:function(e,j){return!e||!e[j]?null:_.isFunction(e[j])?e[j]():e[j]},init:function(e){e=e||{};this.initStart(e);this.userSchema=
e.userSchema;this.loginField=e.loginField;this.passwordField=e.passwordField;this.newPasswordField="new_password";this.publicKey=e.publicKey;this.apiVersion=e.apiVersion||this.DEFAULT_API_VERSION;if("undefined"!==typeof e.apiURL)throw Error("Error: apiURL is no longer supported.  The API URL is now automatically set for PhoneGap users.");var j=e.apiDomain;if("string"===typeof j){if(0==j.indexOf("http"))throw Error("Error: apiDomain should not specify url scheme (http/https). For example, specify api.stackmob.com instead of http://api.stackmob.com. URL Scheme is determined by the 'secure' init variable.");
this.apiDomain=j.indexOf("/")==j.length-1?j:j+"/"}j=0<window.location.hostname.indexOf(".stackmobapp.com");this.useRelativePathForAjax="boolean"===typeof e.useRelativePathForAjax?e.useRelativePathForAjax:j;this.secure=e.secure?e.secure:0==window.location.protocol.indexOf("https:")?this.SECURE_ALWAYS:0==window.location.protocol.indexOf("http:")?this.SECURE_NEVER:this.SECURE_MIXED;this.ajax=e.ajax||this.ajax;this.initEnd(e);return this},initStart:function(){},initEnd:function(){},wrapStackMobCallbacks:function(){}}}).call(this);
(function(){function e(a){var d=a.url.match(/(^http|^https):\/\//g)+StackMob.getBaseURL(),b=a.url.replace(RegExp(d,"g"),"/"),f=d.replace(RegExp("^http://|^https://","g"),"").replace(/\//,""),e=StackMob.Storage.retrieve("oauth2.accessToken"),i=StackMob.Storage.retrieve("oauth2.macKey");StackMob.Storage.retrieve("oauth2.expires");if(StackMob.isOAuth2Mode()&&e&&i){var a=a.type,j=f.split(":"),f=1<j.length?j[0]:f,l=1<j.length?j[1]:"https"==d.substring(0,5)?443:80,d=Math.round((new Date).getTime()/1E3),
j="n"+Math.round(1E4*Math.random()),b=CryptoJS.HmacSHA1(d+"\n"+j+"\n"+a+"\n"+b+"\n"+f+"\n"+l+"\n\n",i).toString(CryptoJS.enc.Base64);return'MAC id="'+e+'",ts="'+d+'",nonce="'+j+'",mac="'+b+'"'}}function j(a,d){var d=d||{},b;if(!0===d.secureRequest)b="https";else switch(StackMob.secure){case StackMob.SECURE_ALWAYS:b="https";break;case StackMob.SECURE_NEVER:b="http";break;default:b=StackMob._isSecureMethod(a,d)?"https":"http"}return b+"://"}var i=this;_.extend(StackMob,{isSencha:function(){return i.Ext},
isZepto:function(){return i.Zepto},initEnd:function(){StackMob.Model=Backbone.Model.extend({urlRoot:StackMob.getBaseURL(),getBinaryFields:function(){return this.binaryFields||[]},url:function(){var a=StackMob.getBaseURL();return a+=this.schemaName},getPrimaryKeyField:function(){return this.schemaName+"_id"},constructor:function(){this.setIDAttribute();Backbone.Model.prototype.constructor.apply(this,arguments)},initialize:function(){StackMob.getProperty(this,"schemaName")||StackMob.throwError("A schemaName must be defined");
this.setIDAttribute()},setIDAttribute:function(){this.idAttribute=this.getPrimaryKeyField()},parse:function(a){return!a||a&&(!a.text||""==a.text)?a:JSON.parse(a.text)},sync:function(a,d,b){StackMob.sync.call(this,a,this,b)},create:function(a){var d={};d[StackMob.FORCE_CREATE_REQUEST]=!0;_.extend(d,a);this.save(null,d)},query:function(a,d){d=d||{};_.extend(d,{query:a});this.fetch(d)},fetch:function(a){StackMob.wrapStackMobCallbacks.call(this,a);Backbone.Model.prototype.fetch.call(this,a)},destroy:function(a){StackMob.wrapStackMobCallbacks.call(this,
a);Backbone.Model.prototype.destroy.call(this,a)},save:function(a,d){var b=a?a.success:{},f=a?a.error:{};"undefined"===typeof d&&(_.isFunction(b)||_.isFunction(f))?(StackMob.wrapStackMobCallbacks.call(this,a),Backbone.Model.prototype.save.call(this,null,a)):(StackMob.wrapStackMobCallbacks.call(this,d),Backbone.Model.prototype.save.call(this,a,d))},fetchExpanded:function(a,d){(0>a||3<a)&&StackMob.throwError("Depth must be between 0 and 3 inclusive.");var b={};_.extend(b,d);b.data=b.data||{};b.data._expand=
a;this.fetch(b)},getAsModel:function(a,d){var b=this.get(a);return b?_.isArray(b)?_.map(b,function(a){return new d(a)}):new d(b):{}},appendAndCreate:function(a,d,b){this.addRelationship(a,d,b)},addRelationship:function(a,d,b){b=b||{};b[StackMob.ARRAY_FIELDNAME]=a;b[StackMob.ARRAY_VALUES]=d;StackMob.sync.call(this,"addRelationship",this,b)},appendAndSave:function(a,d,b){b=b||{};b[StackMob.ARRAY_FIELDNAME]=a;b[StackMob.ARRAY_VALUES]=d;StackMob.sync.call(this,"appendAndSave",this,b)},deleteAndSave:function(a,
d,b,f){f=f||{};f[StackMob.ARRAY_FIELDNAME]=a;f[StackMob.ARRAY_VALUES]=d;f[StackMob.CASCADE_DELETE]=b;var e=this;f.stackmob_ondeleteAndSave=function(){var b=e.get(a);e.set(a,_.difference(b,d))};StackMob.sync.call(this,"deleteAndSave",this,f)},setBinaryFile:function(a,d,b,f){this.set(a,"Content-Type: "+b+"\nContent-Disposition: attachment; filename="+d+"\nContent-Transfer-Encoding: base64\n\n"+f)},incrementOnSave:function(a,d){this.attributes[this.idAttribute]?(this.attributes[a]&&delete this.attributes[a],
this.set(a+"[inc]",d)):StackMob.throwError("Please specify an id for the row you wish to update. When creating a new instance of your object, you need to pass in JSON that includes the id field and value (e.g. var user = new StackMob.User({ username: 'chucknorris' });)  Or, for custom objects: var todoInstance = new Todo({todo_id : '1234'})")},decrementOnSave:function(a,d){this.incrementOnSave(a,-1*d)}});StackMob.Collection=Backbone.Collection.extend({initialize:function(){this.model||StackMob.throwError("Please specify a StackMob.Model for this collection. e.g., var Items = StackMob.Collection.extend({ model: Item });");
this.schemaName=(new this.model).schemaName},url:function(){var a=StackMob.getBaseURL();return a+=this.schemaName},parse:function(a){return!a||a&&(!a.text||""==a.text)?a:JSON.parse(a.text)},sync:function(a,d,b){StackMob.sync.call(this,a,this,b)},query:function(a,d){d=d||{};_.extend(d,{query:a});this.fetch(d)},destroyAll:function(a,d){var d=d||{},b=this,f=d.success;d.success=function(a){b.remove(b.models);"function"==typeof f&&f(a)};_.extend(d,{query:a});return(this.sync||Backbone.sync).call(this,
"delete",this,d)},create:function(a,d){var b={};b[StackMob.FORCE_CREATE_REQUEST]=!0;_.extend(b,d);StackMob.wrapStackMobCallbacks.call(this,b);Backbone.Collection.prototype.create.call(this,a,b)},fetch:function(a){StackMob.wrapStackMobCallbacks.call(this,a);Backbone.Collection.prototype.fetch.call(this,a)},createAll:function(a){a=a||{};return(this.sync||Backbone.sync).call(this,"create",this,a)},count:function(a,d){a=a||new StackMob.Collection.Query;d=d||{};d.stackmob_count=!0;var b=d.success;d.success=
function(a){if(a&&a.getAllResponseHeaders){var d=a.getResponseHeader("Content-Range"),e=0;d&&(e=d.substring(d.indexOf("/")+1,d.length));if(0===e)try{e=JSON.parse(a.responseText).length}catch(i){}b&&b(e)}else b(a)};a.setRange&&(d.query=a.setRange(0,0));return(this.sync||Backbone.sync).call(this,"query",this,d)}});l()},cc:function(a,d,b,f){this.customcode(a,d,b,f)},customcode:function(a,d,b,f){_.isObject(b)?(f=b||{},b=(b=f.httpVerb)&&!_.isUndefined(StackMob.METHOD_MAP[b.toLowerCase()])?b:"GET",f.httpVerb=
b):(f=f||{},_.isString(b)&&(b&&!_.isUndefined(StackMob.METHOD_MAP[b.toLowerCase()]))&&(f.httpVerb=b.toUpperCase()));f.data=f.data||{};"GET"!==b&&(f.contentType=f.contentType||StackMob.CONTENT_TYPE_JSON);_.extend(f.data,d);f.url=j(a,d)+this.getBaseURL();this.sync.call(StackMob,a,null,f)},processLogin:function(a,d){if(StackMob.isOAuth2Mode()){var b=a.access_token,f=a.refresh_token,e=a.mac_key,i=a.expires_in;try{var j=StackMob.getOAuthCredentials(),l=d.stackmob_userschemainfo||j["oauth2.userSchemaInfo"],
p=a.stackmob.user[l.loginField],k=StackMob.prepareCredsForSaving(b,f,e,i,p,l);StackMob.saveOAuthCredentials(k);StackMob.Storage.persist(StackMob.loggedInUserKey,p)}catch(s){console&&console.error("Problem saving OAuth 2.0 credentials and user: "+s)}}},sync:function(a,d,b){b=b||{};if(!StackMob.isAccessTokenMethod(a)&&StackMob.shouldSendRefreshToken()&&!0!==b.stackmob_attempted_refresh){var f=a,i=b;i.stackmob_attempted_refresh=!0;var l=this;StackMob.refreshSession.call(StackMob,{oncomplete:function(){StackMob.sync.call(l,
f,d,i)}});return!1}var t=!0===b[StackMob.FORCE_CREATE_REQUEST];t&&(a="create");var m=_.extend({type:b.httpVerb||StackMob.METHOD_MAP[a]||"GET",dataType:"json"},b);m.data=m.data||{};var p=a,k;k=m||{};var s=j(p,k);!k.url&&d&&(k.url=s+d.url());var s="cc"!=p,y=d&&d.isNew&&!d.isNew(),t=!t,x="addRelationship"==p||"appendAndSave"==p||"deleteAndSave"==p;if(_.include("create update delete read query deleteAndSave appendAndSave addRelationship".split(" "),p)){if(x||s&&y&&t)k.url+=("/"==k.url.charAt(k.url.length-
1)?"":"/")+encodeURIComponent(d.get(d.getPrimaryKeyField())),x&&(k.url+="/"+b[StackMob.ARRAY_FIELDNAME]),"deleteAndSave"==p&&(p="",p=_.isArray(b[StackMob.ARRAY_VALUES])?_.map(b[StackMob.ARRAY_VALUES],function(a){return encodeURIComponent(a)}).join(","):encodeURIComponent(b[StackMob.ARRAY_VALUES]),k.url+="/"+p)}else k.url+=("/"==k.url.charAt(k.url.length-1)?"":"/")+p;k=a;p=b||{};m.headers=m.headers||{};m.headers=_.extend({Accept:"application/vnd.stackmob+json; version="+StackMob.apiVersion},m.headers);
_.extend(m.headers,{"X-StackMob-User-Agent":"StackMob (JS; "+StackMob.sdkVersion+")"});StackMob.publicKey&&!StackMob.privateKey?(m.headers["X-StackMob-API-Key"]=StackMob.publicKey,m.headers["X-StackMob-Proxy-Plain"]="stackmob-api",m.headers["X-StackMob-API-Key-"+StackMob.publicKey]="1"):m.headers["X-StackMob-Proxy"]="stackmob-api";StackMob.isOAuth2Mode()&&StackMob.isAccessTokenMethod(k)?m.contentType="application/x-www-form-urlencoded":_.include(["PUT","POST"],StackMob.METHOD_MAP[k])&&(m.contentType=
m.contentType||StackMob.CONTENT_TYPE_JSON);isNaN(p[StackMob.CASCADE_DELETE])||(m.headers["X-StackMob-CascadeDelete"]=!0==p[StackMob.CASCADE_DELETE]);if(p.query&&(k=m.query||throwError("No StackMobQuery object provided to the query call."),k.selectFields&&0<k.selectFields.length&&(m.headers["X-StackMob-Select"]=k.selectFields.join()),k.range&&(m.headers.Range="objects="+k.range.start+"-"+k.range.end),_.extend(m.data,k.params),k.orderBy&&0<k.orderBy.length)){k=k.orderBy;p="";s=k.length;for(y=0;y<s;y++)p+=
k[y],y+1<s&&(p+=",");m.headers["X-StackMob-OrderBy"]=p}k=a;s=function(a){return _.map(_.keys(a),function(b){return b+"="+encodeURIComponent(a[b])}).join("&")};p=b||{};if(StackMob.isOAuth2Mode()&&StackMob.isAccessTokenMethod(k))m.data=s(m.data);else if("POST"==m.type||"PUT"==m.type)if("resetPassword"==k||"forgotPassword"==k)m.data=JSON.stringify(m.data);else if("addRelationship"==k||"appendAndSave"==k)p&&p[StackMob.ARRAY_VALUES]&&(m.data=JSON.stringify(p[StackMob.ARRAY_VALUES]));else if(d){var r=d.toJSON();
_.each(p.remote_ignore||[],function(a){delete r[a]});delete r.lastmoddate;delete r.createddate;"update"==k&&((k=p.stackmob_userschemainfo||StackMob.getOAuthCredentials()["oauth2.userSchemaInfo"])&&delete r[k.passwordField],_.each(d.getBinaryFields(),function(a){r[a]&&0==r[a].indexOf("http")&&delete r[a]}));StackMob.isOAuth2Mode()&&delete r.sm_owner;m.data=JSON.stringify(_.extend(r,m.data))}else m.data=JSON.stringify(m.data);else{if(("GET"==m.type||"DELETE"==m.type)&&!_.isEmpty(m.data))m.url+="?",
k=s(m.data),m.url+=k;delete m.data}k=m||{};k.processData=!1;k.accepts=k.headers.Accept;StackMob.isAccessTokenMethod(a)||(k=e(m))&&(m.headers.Authorization=k);StackMob.makeAPICall(d,m,a,b)},refreshSession:function(a){var d={};_.extend(d,a);if(StackMob.hasRefreshToken()){var b=StackMob.getOAuthCredentials()["oauth2.userSchemaInfo"]?StackMob.getOAuthCredentials()["oauth2.userSchemaInfo"].schemaName:StackMob.userSchema;d.url=j("refreshToken")+this.getBaseURL()+b;d.contentType="application/x-www-form-urlencoded";
d.data={refresh_token:StackMob.getOAuthCredentials()[StackMob.REFRESH_TOKEN_KEY],grant_type:"refresh_token",token_type:"mac",mac_algorithm:"hmac-sha1"};var f=a.oncomplete;f&&(d.oncomplete=function(){f()});a&&a.success&&(d.success=a.success);d.stackmob_onrefreshToken=StackMob.processLogin;d.error=function(){a&&a.error&&a.error();StackMob.Storage.remove(StackMob.REFRESH_TOKEN_KEY)};(this.sync||Backbone.sync).call(this,"refreshToken",this,d)}else a&&a.error&&a.error()},makeAPICall:function(a,d,b,f){return StackMob.ajax?
StackMob.ajax(a,d,b,f):StackMob.isSencha()?StackMob.ajaxOptions.sencha(a,d,b,f):StackMob.isZepto()?StackMob.ajaxOptions.zepto(a,d,b,f):StackMob.ajaxOptions.jquery(a,d,b,f)},onsuccess:function(a,d,b,f,e,i){if(b){if(_.isFunction(b["stackmob_on"+d]))b["stackmob_on"+d](f,i);if(_.isFunction(b.oncomplete))b.oncomplete(f)}if(e)if(f)if(StackMob.isOAuth2Mode()&&StackMob.isAccessTokenMethod(d)&&f.stackmob){f=f.stackmob.user;d=!0===i.fullyPopulateUser;if(a&&a.parse)if(d){if(!a.set(a.parse(f,i),i))return!1}else if(b=
{},b[a.getPrimaryKeyField()]=f[a.getPrimaryKeyField()],!a.set(b,i))return!1;e(f);d&&(a&&a.trigger)&&a.trigger("sync",a,f,i)}else e(f);else e()},onerror:function(a,d,b,f,i,j){var f=a.status,l;try{l=JSON.parse(d)}catch(m){l={error:"Invalid JSON returned."}}if(503==f){a=a.getResponseHeader("retry-after");try{a=1E3*parseInt(responseHeaderValue)}catch(p){a=StackMob.RETRY_WAIT}if("number"===typeof i.stackmob_retry){if(i.stackmob_retry-=1,0>=i.stackmob_retry)return}else i.stackmob_retry=StackMob.RETRY_ATTEMPTS;
_.delay(function(){var a=e(i);i.headers.Authorization=a;b&&b(i)},a)}else{if(_.isFunction(i.oncomplete))i.oncomplete(l);j&&j(l)}},isAccessTokenMethod:function(a){return _.include(["accessToken","refreshToken","facebookAccessToken","facebookAccessTokenWithCreate","gigyaAccessToken"],a)},_isSecureMethod:function(a,d){var b="loginWithTempAndSetNewPassword createUserWithFacebook linkUserWithFacebook unlinkUserFromFacebook linkUserWithGigya unlinkUserFromGigya".split(" ");return StackMob.isAccessTokenMethod(a)?
!0:!0==d.isUserCreate?!0:_.include(b,a)}});var l=function(){StackMob.User=StackMob.Model.extend({schemaName:StackMob.userSchema||StackMob.DEFAULT_LOGIN_SCHEMA,loginField:StackMob.loginField||StackMob.DEFAULT_LOGIN_FIELD,passwordField:StackMob.passwordField||StackMob.DEFAULT_PASSWORD_FIELD,idAttribute:this.loginField,getPrimaryKeyField:function(){return this.loginField},create:function(a){a=a||{};a.isUserCreate=!0;StackMob.Model.prototype.create.call(this,a)},isLoggedIn:function(a){a=a||{};if(StackMob._containsCallbacks(a,
["yes","no"]))a=StackMob._generateCallbacks(a,{isValidResult:function(a){return"undefined"!==typeof a},yes:a.yes,no:a.no,error:a.no}),StackMob.hasValidOAuth(a);else return StackMob.isUserLoggedIn(this.get(this.loginField),a)},login:function(a,d){d=d||{};StackMob.keepLoggedIn("undefined"===typeof a?!1:a);d.data=d.data||{};d.data[this.loginField]=this.get(this.loginField);d.data[this.passwordField]=this.get(this.passwordField);StackMob.isOAuth2Mode()&&(d.data.token_type="mac");d.stackmob_onaccessToken=
StackMob.processLogin;(this.sync||Backbone.sync).call(this,StackMob.isOAuth2Mode()?"accessToken":"login",this,d)},logout:function(a){a=a||{};a.data=a.data||{};(this.sync||Backbone.sync).call(this,"logout",this,a);StackMob.clearOAuthCredentials()},loginWithGigya:function(a,d,b,f,e){e=e||{};StackMob.keepLoggedIn("undefined"===typeof f?!1:f);e.data=e.data||{};_.extend(e.data,{gigya_uid:a,gigya_ts:d,gigya_sig:b,token_type:"mac"});e.stackmob_ongigyaAccessToken=StackMob.processLogin;(this.sync||Backbone.sync).call(this,
"gigyaAccessToken",this,e)},linkUserWithGigya:function(a,d,b,f){f=f||{};f.data=f.data||{};_.extend(f.data,{gigya_uid:a,gigya_ts:d,gigya_sig:b,token_type:"mac"});(this.sync||Backbone.sync).call(this,"linkUserWithGigya",this,f)},unlinkUserFromGigya:function(a){(this.sync||Backbone.sync).call(this,"unlinkUserFromGigya",this,a)},loginWithFacebook:function(a,d,b){this.loginWithFacebookToken(a,d,b)},loginWithFacebookToken:function(a,d,b){b=b||{};StackMob.keepLoggedIn("undefined"===typeof d?!1:d);b.data=
b.data||{};_.extend(b.data,{fb_at:a,token_type:"mac"});!0===b.createIfNeeded?(b.stackmob_onfacebookAccessTokenWithCreate=StackMob.processLogin,b.data[this.loginField]=b[this.loginField]||this.get(this.loginField),(this.sync||Backbone.sync).call(this,"facebookAccessTokenWithCreate",this,b)):(b.stackmob_onfacebookAccessToken=StackMob.processLogin,(this.sync||Backbone.sync).call(this,"facebookAccessToken",this,b))},loginWithFacebookAutoCreate:function(a,d,b){b=b||{};b.createIfNeeded=!0;this.loginWithFacebookToken(a,
d,b)},createUserWithFacebook:function(a,d){d=d||{};d.data=d.data||{};_.extend(d.data,{fb_at:a,token_type:"mac"});d.data[this.loginField]=d[this.loginField]||this.get(this.loginField);(this.sync||Backbone.sync).call(this,"createUserWithFacebook",this,d)},linkUserWithFacebook:function(a,d){d=d||{};d.data=d.data||{};_.extend(d.data,{fb_at:a,token_type:"mac"});(this.sync||Backbone.sync).call(this,"linkUserWithFacebook",this,d)},unlinkUserFromFacebook:function(a){(this.sync||Backbone.sync).call(this,"unlinkUserFromFacebook",
this,a)},loginWithTempAndSetNewPassword:function(a,d,b,f){f=f||{};f.data=f.data||{};this.set(this.passwordField,a);f.data[StackMob.newPasswordField]=d;this.login(b,f)},forgotPassword:function(a){a=a||{};a.data=a.data||{};a.data[this.loginField]=this.get(this.loginField);(this.sync||Backbone.sync).call(this,"forgotPassword",this,a)},resetPassword:function(a,d,b){b=b||{};b.data=b.data||{};b.data.old={password:a};b.data["new"]={password:d};(this.sync||Backbone.sync).call(this,"resetPassword",this,b)},
sync:function(a,d,b){b=b||{};b.stackmob_userschemainfo={schemaName:this.schemaName,loginField:this.loginField,passwordField:this.passwordField};StackMob.Model.prototype.sync.call(this,a,d,b)}});StackMob.Users=StackMob.Collection.extend({model:StackMob.User});StackMob.GeoPoint=function(a,d){_.isNumber(a)?((-90>a||90<a)&&StackMob.throwError("Latitude value must be between -90 and 90 inclusive."),(-180>d||180<d)&&StackMob.throwError("Longitude value must be between -180 and 180 inclusive."),this.lat=
a,this.lon=d):((-90>a.lat||90<a.lat)&&StackMob.throwError("Latitude value must be between -90 and 90 inclusive."),(-180>a.lon||180<a.lon)&&StackMob.throwError("Longitude value must be between -180 and 180 inclusive."),this.lat=a.lat,this.lon=a.lon)};StackMob.GeoPoint.prototype.toJSON=function(){return{lat:this.lat,lon:this.lon}};StackMob.Model.Query=function(){this.selectFields=[];this.params={}};_.extend(StackMob.Model.Query.prototype,{select:function(a){this.selectFields.push(a);return this},setExpand:function(a){this.params._expand=
a;return this}});StackMob.Collection.Query=function(){this.params={};this.selectFields=[];this.orderBy=[];this.range=null};StackMob.Collection.Query.prototype=new StackMob.Model.Query;StackMob.Collection.Query.prototype.constructor=StackMob.Collection.Query;_.extend(StackMob.Collection.Query.prototype,{or:function(a){if("undefined"==typeof this.orId){var d=this.clone();d.params={};d.orId=1;d.andCount=1;var b,f;f=_.keys(this.params);b="";1<f.length&&(b=d.andCount++,b="[and"+b+"].");for(key in this.params)f=
"[or"+d.orId+"]."+b+key,d.params[f]=this.params[key]}else d=this.clone();f=_.keys(a.params);b="";1<f.length&&(b=d.andCount++,b="[and"+b+"].");for(key in a.params){f="[or"+d.orId+"]."+b+key;if("undefined"!==typeof d.params[f])throw Error("Error: You are attempting to OR two or more values for the same field. You should use an mustBeOneOf method instead.");d.params[f]=a.params[key]}return d},and:function(a){var d=this.clone(),b;for(b in a.params)d.params[b]=a.params[b];return d},clone:function(){var a=
_.clone(this);a.params=_.clone(this.params);return a},addParam:function(a,d){this.params[a]=d;return this},equals:function(a,d){""===d?this.params[a+"[empty]"]=!0:this.params[a]=d;return this},lt:function(a,d){this.params[a+"[lt]"]=d;return this},lte:function(a,d){this.params[a+"[lte]"]=d;return this},gt:function(a,d){this.params[a+"[gt]"]=d;return this},gte:function(a,d){this.params[a+"[gte]"]=d;return this},notEquals:function(a,d){""===d?this.params[a+"[empty]"]=!1:this.params[a+"[ne]"]=d;return this},
isNull:function(a){this.params[a+"[null]"]=!0;return this},isNotNull:function(a){this.params[a+"[null]"]=!1;return this},mustBeOneOf:function(a,d){var b="";if(_.isArray(d))for(var f=d.length,e=0;e<f;e++)b+=d[e],e+1<f&&(b+=",");else b=d;this.params[a+"[in]"]=b;return this},orderAsc:function(a){this.orderBy.push(a+":asc");return this},orderDesc:function(a){this.orderBy.push(a+":desc");return this},setRange:function(a,d){this.range={start:a,end:d};return this},mustBeNear:function(a,d,b){this.params[a+
"[near]"]=d.lat+","+d.lon+","+b;return this},mustBeNearMi:function(a,d,b){this.mustBeNear(a,d,b/StackMob.EARTH_RADIANS_MI);return this},mustBeNearKm:function(a,d,b){this.mustBeNear(a,d,b/StackMob.EARTH_RADIANS_KM);return this},isWithin:function(a,d,b){this.params[a+"[within]"]=d.lat+","+d.lon+","+b;return this},isWithinMi:function(a,d,b){this.isWithin(a,d,b/StackMob.EARTH_RADIANS_MI);return this},isWithinKm:function(a,d,b){this.isWithin(a,d,b/StackMob.EARTH_RADIANS_KM);return this},isWithinBox:function(a,
d,b){this.params[a+"[within]"]=d.lat+","+d.lon+","+b.lat+","+b.lon;return this}})}}).call(this);
(function(){var e=this.jQuery||this.Ext||this.Zepto;_.extend(StackMob,{ajaxOptions:{sencha:function(j,i,l,a){var d={},b=i.success;i.success=function(d){var f=d&&d.responseText?JSON.parse(d.responseText):null;!0===i.stackmob_count&&(f=d);StackMob.onsuccess(j,l,i,f,b,a)};var f=i.error;d.url=i.url;d.headers=i.headers;d.params=i.data;d.success=i.success;d.disableCaching=!1;d.method=i.type;i.error=function(a,b){StackMob.onerror(a,a.responseText||a.text,e.Ajax.request,j,d,f,b)};d.failure=i.error;return e.Ajax.request(d)},
zepto:function(j,i,l,a){var d=i.success,b=function(b,f){f=b?JSON.parse(b):null;StackMob.onsuccess(j,l,i,f,d,a)};i.success=b;var f=i.error,n=function(b){StackMob.onerror(b,b.responseText||b.text,e.ajax,j,i,f,a)};i.error=n;var u={};u.url=i.url;u.headers=i.headers;u.contentType=i.headers.contentType;u.type=i.type;u.data=i.data;u.success=b;u.error=n;return e.ajax(u)},jquery:function(j,i,l,a){i.beforeSend=function(a,b){a.setRequestHeader("Accept",b.accepts);if(!_.isEmpty(b.headers))for(key in b.headers)a.setRequestHeader(key,
b.headers[key])};var d=i.error;i.error=function(b,l,u){if(0==b.status&&i.query&&"object"===typeof i.query.range)this.success(b,l,u);else StackMob.onerror(b,b.responseText||b.text,e.ajax,j,i,d,a)};var b=i.success;i.success=function(d,e,u){var t;!0===i.stackmob_count?t=u:d&&d.toJSON?t=d:d&&(d.responseText||d.text)?t=JSON.parse(d.responseText||d.text):d&&(t=d);StackMob.onsuccess(j,l,i,t,b,a)};return e.ajax(i)}}})}).call(this);
var CryptoJS=CryptoJS||function(e,j){var i={},l=i.lib={},a=function(){},d=l.Base={extend:function(b){a.prototype=this;var d=new a;b&&d.mixIn(b);d.$super=this;return d},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.$super.extend(this)}},b=l.WordArray=d.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=
b!=j?b:4*a.length},toString:function(a){return(a||n).stringify(this)},concat:function(a){var b=this.words,d=a.words,f=this.sigBytes,a=a.sigBytes;this.clamp();if(f%4)for(var e=0;e<a;e++)b[f+e>>>2]|=(d[e>>>2]>>>24-8*(e%4)&255)<<24-8*((f+e)%4);else if(65535<d.length)for(e=0;e<a;e+=4)b[f+e>>>2]=d[e>>>2];else b.push.apply(b,d);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-8*(b%4);a.length=e.ceil(b/4)},clone:function(){var a=d.clone.call(this);
a.words=this.words.slice(0);return a},random:function(a){for(var d=[],f=0;f<a;f+=4)d.push(4294967296*e.random()|0);return b.create(d,a)}}),f=i.enc={},n=f.Hex={stringify:function(a){for(var b=a.words,a=a.sigBytes,d=[],f=0;f<a;f++){var e=b[f>>>2]>>>24-8*(f%4)&255;d.push((e>>>4).toString(16));d.push((e&15).toString(16))}return d.join("")},parse:function(a){for(var d=a.length,f=[],e=0;e<d;e+=2)f[e>>>3]|=parseInt(a.substr(e,2),16)<<24-4*(e%8);return b.create(f,d/2)}},u=f.Latin1={stringify:function(a){for(var b=
a.words,a=a.sigBytes,d=[],f=0;f<a;f++)d.push(String.fromCharCode(b[f>>>2]>>>24-8*(f%4)&255));return d.join("")},parse:function(a){for(var d=a.length,f=[],e=0;e<d;e++)f[e>>>2]|=(a.charCodeAt(e)&255)<<24-8*(e%4);return b.create(f,d)}},t=f.Utf8={stringify:function(a){try{return decodeURIComponent(escape(u.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return u.parse(unescape(encodeURIComponent(a)))}},m=l.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=b.create();
this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=t.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var d=this._data,f=d.words,i=d.sigBytes,j=this.blockSize,l=i/(4*j),l=a?e.ceil(l):e.max((l|0)-this._minBufferSize,0),a=l*j,i=e.min(4*a,i);if(a){for(var m=0;m<a;m+=j)this._doProcessBlock(f,m);m=f.splice(0,a);d.sigBytes-=i}return b.create(m,i)},clone:function(){var a=d.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});l.Hasher=m.extend({init:function(){this.reset()},
reset:function(){m.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);this._doFinalize();return this._hash},clone:function(){var a=m.clone.call(this);a._hash=this._hash.clone();return a},blockSize:16,_createHelper:function(a){return function(b,d){return a.create(d).finalize(b)}},_createHmacHelper:function(a){return function(b,d){return p.HMAC.create(a,d).finalize(b)}}});var p=i.algo={};return i}(Math);
(function(){var e=CryptoJS,j=e.lib,i=j.WordArray,j=j.Hasher,l=[],a=e.algo.SHA1=j.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var f=this._hash.words,e=f[0],i=f[1],j=f[2],m=f[3],p=f[4],k=0;80>k;k++){if(16>k)l[k]=a[b+k]|0;else{var s=l[k-3]^l[k-8]^l[k-14]^l[k-16];l[k]=s<<1|s>>>31}s=(e<<5|e>>>27)+p+l[k];s=20>k?s+((i&j|~i&m)+1518500249):40>k?s+((i^j^m)+1859775393):60>k?s+((i&j|i&m|j&m)-1894007588):s+((i^j^m)-
899497514);p=m;m=j;j=i<<30|i>>>2;i=e;e=s}f[0]=f[0]+e|0;f[1]=f[1]+i|0;f[2]=f[2]+j|0;f[3]=f[3]+m|0;f[4]=f[4]+p|0},_doFinalize:function(){var a=this._data,b=a.words,f=8*this._nDataBytes,e=8*a.sigBytes;b[e>>>5]|=128<<24-e%32;b[(e+64>>>9<<4)+15]=f;a.sigBytes=4*b.length;this._process()}});e.SHA1=j._createHelper(a);e.HmacSHA1=j._createHmacHelper(a)})();
(function(){var e=CryptoJS,j=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,l){e=this._hasher=e.create();"string"==typeof l&&(l=j.parse(l));var a=e.blockSize,d=4*a;l.sigBytes>d&&(l=e.finalize(l));for(var b=this._oKey=l.clone(),f=this._iKey=l.clone(),n=b.words,u=f.words,t=0;t<a;t++)n[t]^=1549556828,u[t]^=909522486;b.sigBytes=f.sigBytes=d;this.reset()},reset:function(){var e=this._hasher;e.reset();e.update(this._iKey)},update:function(e){this._hasher.update(e);return this},finalize:function(e){var j=
this._hasher,e=j.finalize(e);j.reset();return j.finalize(this._oKey.clone().concat(e))}})})();
(function(){var e=CryptoJS,j=e.lib.WordArray;e.enc.Base64={stringify:function(e){var j=e.words,a=e.sigBytes,d=this._map;e.clamp();for(var e=[],b=0;b<a;b+=3)for(var f=(j[b>>>2]>>>24-8*(b%4)&255)<<16|(j[b+1>>>2]>>>24-8*((b+1)%4)&255)<<8|j[b+2>>>2]>>>24-8*((b+2)%4)&255,n=0;4>n&&b+0.75*n<a;n++)e.push(d.charAt(f>>>6*(3-n)&63));if(j=d.charAt(64))for(;e.length%4;)e.push(j);return e.join("")},parse:function(e){var e=e.replace(/\s/g,""),l=e.length,a=this._map,d=a.charAt(64);d&&(d=e.indexOf(d),-1!=d&&(l=d));
for(var d=[],b=0,f=0;f<l;f++)if(f%4){var n=a.indexOf(e.charAt(f-1))<<2*(f%4),u=a.indexOf(e.charAt(f))>>>6-2*(f%4);d[b>>>2]|=(n|u)<<24-8*(b%4);b++}return j.create(d,b)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();
